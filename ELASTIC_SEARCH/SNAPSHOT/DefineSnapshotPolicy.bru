meta {
  name: DefineSnapshotPolicy
  type: http
  seq: 5
}

put {
  url: {{esUrl}}/_slm/policy/{{policy}}
  body: json
  auth: none
}

body:json {
  {
    "schedule": "0 30 1 * * ?",
    "name": "<nightly-snap-{now/d}>",
    "repository": "my_repository",
    "config": {
      "indices": [
        "*"
      ]
    },
    "retention": {
      "expire_after": "30d",
      "min_count": 5,
      "max_count": 50
    }
  }
}

vars:pre-request {
  policy: policy_name
}
